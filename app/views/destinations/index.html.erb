<% content_for :title, "Destinations" %>

<style>
  .destination-row {
    transition: all 0.2s ease-in-out;
  }
  .destination-row:hover {
    background-color: #e3f2fd !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transform: translateX(4px);
  }
  .table {
    border-radius: 12px;
    overflow: hidden;
  }
</style>

<div class="container my-5">
  <p class="mt-2 text-success"><%= notice %></p>
  <h1 class="mb-2 text-center">Explore Popular Destinations</h1>
  <p class="text-center text-muted mb-4">
    <i class="bi bi-info-circle"></i> Click on any destination to explore details, view on map, and manage your plans
  </p>
  
  <div class="d-flex justify-content-end mb-3">
    <%= link_to "Add Destination", new_destination_path, class: "btn btn-success" %>
  </div>

  <% if current_user && current_user.current_country.present? && @domestic_destinations.any? %>
    <!-- Domestic Destinations Section -->
    <div class="mb-5">
      <h2 class="mb-3">
        <i class="bi bi-house-heart"></i> Domestic Destinations
        <small class="text-muted">(in <%= current_user.current_country %>)</small>
      </h2>
      <table class="table table-striped table-hover rounded shadow">
        <thead class="table-success">
          <tr>
            <th>Name</th>
            <th>Country</th>
            <th>Safety</th>
          </tr>
        </thead>
        <tbody>
          <% @domestic_destinations.each do |destination| %>
            <tr style="cursor: pointer;" onclick="window.location='<%= destination_path(destination) %>'" class="destination-row">
              <td class="fw-bold"><%= destination.name %></td>
              <td><%= destination.country %></td>
              <td>
                <span class="badge bg-info text-dark"><%= destination.safety_score %>/10</span>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
      <%= pagy_nav(@pagy_domestic) if defined?(@pagy_domestic) %> 
    </div>
  <% end %>

  <% if @international_destinations.any? %>
    <!-- International Destinations Section -->
    <div class="mb-5">
      <h2 class="mb-3">
        <i class="bi bi-globe"></i> International Destinations
      </h2>
      <table class="table table-striped table-hover rounded shadow">
        <thead class="table-primary">
          <tr>
            <th>Name</th>
            <th>Country</th>
            <th>Visa Required</th>
            <th>Safety</th>
          </tr>
        </thead>
        <tbody>
          <% @international_destinations.each do |destination| %>
            <tr style="cursor: pointer;" onclick="window.location='<%= destination_path(destination) %>'" class="destination-row">
              <td class="fw-bold"><%= destination.name %></td>
              <td><%= destination.country %></td>
              <td>
                <span class="badge <%= destination.visa_required ? 'bg-danger' : 'bg-success' %>">
                  <%= destination.visa_required ? "Yes" : "No" %>
                </span>
              </td>
              <td>
                <span class="badge bg-info text-dark"><%= destination.safety_score %>/10</span>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
      <%= pagy_nav(@pagy_international) if defined?(@pagy_international) %> 
    </div>
  <% else %>
    <div class="alert alert-info text-center">
      <p class="mb-0">No destinations available. <%= link_to "Add the first destination", new_destination_path, class: "alert-link" %>.</p>
    </div>
  <% end %>
</div>
